<view class="container">
  <view class="status-card card" wx:if="{{order}}">
    <view class="status-icon">
      <image src="/images/status-{{order.status}}.png" class="icon" mode="aspectFit" />
    </view>
    <view class="status-text">{{getStatusText(order.status)}}</view>
  </view>

  <view class="info-card card" wx:if="{{order}}">
    <view class="card-title">订单信息</view>
    <view class="info-item">
      <text class="label">订单类型</text>
      <text class="value order-type-badge {{order.order_type}}">
        {{order.order_type === 'dine_in' ? '🍽️ 堂食' : '🚚 外卖'}}
      </text>
    </view>
    <view class="info-item">
      <text class="label">订单号</text>
      <text class="value">{{order.order_no}}</text>
    </view>
    <view class="info-item">
      <text class="label">下单时间</text>
      <text class="value">{{order.created_at}}</text>
    </view>
    <view class="info-item" wx:if="{{order.paid_at}}">
      <text class="label">支付时间</text>
      <text class="value">{{order.paid_at}}</text>
    </view>
  </view>

  <!-- 堂食信息 -->
  <view class="info-card card" wx:if="{{order && order.order_type === 'dine_in'}}">
    <view class="card-title">堂食信息</view>
    <view class="info-item" wx:if="{{order.table_number}}">
      <text class="label">桌号</text>
      <text class="value">{{order.table_number}}</text>
    </view>
    <view class="info-item" wx:if="{{order.serve_time}}">
      <text class="label">上菜时间</text>
      <text class="value">{{order.serve_time}}</text>
    </view>
    <view class="info-item">
      <text class="label">联系人</text>
      <text class="value">{{order.contact_name}}</text>
    </view>
    <view class="info-item">
      <text class="label">联系电话</text>
      <text class="value">{{order.contact_phone}}</text>
    </view>
    <view class="info-item" wx:if="{{order.remark}}">
      <text class="label">备注</text>
      <text class="value">{{order.remark}}</text>
    </view>
  </view>

  <!-- 外卖配送信息 -->
  <view class="info-card card" wx:if="{{order && order.order_type === 'delivery'}}">
    <view class="card-title">配送信息</view>
    <view class="info-item">
      <text class="label">联系人</text>
      <text class="value">{{order.contact_name}}</text>
    </view>
    <view class="info-item">
      <text class="label">联系电话</text>
      <text class="value">{{order.contact_phone}}</text>
    </view>
    <view class="info-item">
      <text class="label">配送地址</text>
      <text class="value">{{order.delivery_address}}</text>
    </view>
    <view class="info-item" wx:if="{{order.remark}}">
      <text class="label">备注</text>
      <text class="value">{{order.remark}}</text>
    </view>
  </view>

  <view class="dishes-card card" wx:if="{{order}}">
    <view class="card-title">订单商品</view>
    <view class="dish-item" wx:for="{{order.items}}" wx:key="id">
      <image src="{{item.dish_image}}" class="dish-image" mode="aspectFill" />
      <view class="dish-info">
        <text class="dish-name">{{item.dish_name}}</text>
        <text class="dish-quantity">x{{item.quantity}}</text>
      </view>
      <text class="dish-price">¥{{item.price}}</text>
    </view>
    <view class="total-row">
      <text class="total-label">合计</text>
      <text class="total-price">¥{{order.total_amount}}</text>
    </view>
  </view>

  <view class="actions" wx:if="{{order && order.status === 'pending'}}">
    <button class="btn-cancel" bindtap="cancelOrder">取消订单</button>
    <button class="btn-pay btn-primary" bindtap="payOrder">去支付</button>
  </view>
</view>

